# 多层感知机——Multi-Layer Perceptron, MLP

>参考文献：
>
>[CSDN博主chengchaowei](https://blog.csdn.net/weixin_38347387/article/details/82936585)
>
>[飞行器智能感知与控制实验室布树辉教授](https://gitee.com/pi-lab/machinelearning_notebook/blob/master/5_nn/2-mlp_bp.ipynb)
>
>[神经网络图在线编辑](http://alexlenail.me/NN-SVG/index.html)

## 1、定义

如下图所示，典型的多层神经网络主要由三部分构成：`输入层`、`隐藏层`、`输出层`。MLP神经网络不同层之间是全连接的（全连接的意思就是：上一层的任何一个神经元与下一层的所有神经元都有连接）。第一层是输入层，包括两个神经元和截距b1，负责接收输入数据；第二层是隐含层，包括两个神经元和截距b2，它们对于外部来说是不可见的；第三层是输出层，可以从这层获取神经网络输出数据。神经网络主要有三个基本要素：权重、偏置和激活函数。

* 权重：神经元之间的连接强度由权重控制，权重的大小表示可能性的大小
* 偏置：偏置的设置是为了正确分类样本，是模型中一个重要的参数，即保证通过输入算出的输出值不能随便激活。
* 激活函数：起非线性映射的作用，其可将神经元的输出幅度限制在一定范围内，一般限制在（-1~1）或（0~1）之间。最常用的激活函数是Sigmoid函数，可将（-∞，+∞）的数映射到（0~1）的范围内。

不同神经元之间连线上标注的是相邻层神经元之间的权重，这里的激活函数选择为sigmoid函数。

<p align="center">
    <img src="./images/fcn.png"/>
</p>
sigmoid函数是一个非线性函数，值域是(0,1)。函数图像如下图所示。

<p align="center">
    <img src="./images/sigmoid.jpg"/>
</p>




sigmoid函数的数学定义为：
$$
sigmoid(x)=\frac{1}{1+e^{-x}}
$$
sigmoid函数的导数为：
$$
y=sigmoid(x)y^,=y(1-y)
$$
可以看到，sigmoid函数的导数可以用sigmoid函数自身来表示。这样，一旦计算出sigmoid函数的值，计算它的导数的值就非常方便。

## 2、正向传播

神经网络正向传播的过程比较简单，就是将数据灌入到神经网络中一层一层的不断进行计算，最终将计算结果输出，动态演示过程如下图所示。

<p align="center">
    <img src="./images/fcn.gif"/>
</p>

下面首先讲述神经网络正向传播的计算原理，然后结合具体的例子来讲解神经网络的计算过程。

神经网络实际上就是一个输入向量*x*⃗ 到输出向量*y*⃗ 的函数，即：
$$
y=f_{network}(x)
$$
神经网络正向传播的计算过程为：

* 首先将输入向量的每个元素赋值给神经网络输入层对应的神经元

* 然后根据公式$sigmoid(w^Tx)$依次向前计算每一层神经元的数值，直到最后一层输出层所有神经元的数值计算完毕为止

* 最后，将神经元所有的输出值相加计算得到神经网络的输出向量$y$

  ### **神经网络正向传播实例**

    <p align="center">
        <img src="./images/fcn2.png"/>
    </p>

  输入数据	$i_1=0.05$，$i_2=0.10$

  输出数据	$o_1=0.01$，$o_2=0.99$

  初始权重	$w_1=0.15$，$w_2=0.20$，$w_3=0.25$，$w_4=0.30$

  ​				   $w_5=0.40$，$w_6=0.45$，$w_7=0.50$，$w_8=0.55$

* **1、输入层到隐含层**
  
  计算神经元h1的输入加权和：
  $$
  net_{h1}=w_1*i_1+w_2*i_2+b_1*1 \\
  net_{h1}=0.15*0.05+0.2*0.1+0.35*1=0.3775
  $$
  

​		将`加权和`代入激活函数中进行求解（sigmoid函数）：
$$
out_{h1}=\frac{1}{1+e^{-net_{h1}}}=\frac{1}{1+e^{-0.3775}}=0.593269992
$$
​		同理，可计算得出神经元h2的输出$out_{h2}=0.596884378$

* **2、隐含层到输出层**

  ​	计算输出神经元o1和o2的值：
  $$
  net_{o1}=w_5*out_{h1}+w_6*out_{h2}+b_2*1 \\
  net_{o1}=0.4*0.59326992+0.45*0.596884378+0.6*1=1.105905967 \\
  out_{o1}=\frac{1}{1+e^{net_o1}}=\frac{1}{1+e^{-1.105905967}}=0.75136507
  $$
  同理可进一步得到$out_{o2}=0.772928465$，上述就是神经网络整个前向传播的计算过程，经过计算我们得到神经网络的两个输出数值为`[1.105905967，0.75136507]`，该数值与给出的标签数值（ground-truth）相差甚远，因此还需要进一步通过反向传播的方式`更新权重`，重新计算神经网络的输出。

## 3、反向传播



## 4、代码实现

```python

```







